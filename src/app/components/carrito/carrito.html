<!-- CARRITO DE COMPRAS YOLIK -->

<!-- HEADER DEL CARRITO -->
<section class="w-full h-[35vh] relative overflow-hidden bg-gradient-to-r from-[#D11C5E] to-[#E63E6D]">
  <div class="absolute inset-0 bg-black/20"></div>
  <img src="https://images.unsplash.com/photo-1590736704728-f4730bb30770?q=80&w=2000"
       class="absolute w-full h-full object-cover opacity-30 mix-blend-overlay"
       alt="Carrito YOLIK">

  <div class="relative z-10 flex flex-col items-center justify-center h-full text-white px-4">
    <div class="mb-4">
      <i class="fa-solid fa-bag-shopping text-5xl"></i>
    </div>
    <h1 class="text-5xl md:text-7xl font-black uppercase tracking-tighter mb-4">
      Mi Carrito
    </h1>
    <p class="text-lg md:text-xl font-light tracking-widest uppercase">
      @if (itemCount > 0) {
        {{ itemCount }} {{ itemCount === 1 ? 'Producto' : 'Productos' }}
      } @else {
        Carrito Vacío
      }
    </p>
  </div>
</section>

<!-- CONTENIDO DEL CARRITO -->
<section class="w-full bg-gray-50 py-12 min-h-[60vh]">
  <div class="px-6 md:px-12 max-w-7xl mx-auto">

    @if (cartItems.length === 0) {
      <!-- CARRITO VACÍO -->
      <div class="flex flex-col items-center justify-center py-20">
        <div class="bg-white rounded-full w-32 h-32 flex items-center justify-center mb-6 shadow-lg">
          <i class="fa-solid fa-bag-shopping text-6xl text-gray-300"></i>
        </div>
        <h2 class="text-3xl font-black text-gray-700 mb-4">Tu carrito está vacío</h2>
        <p class="text-gray-500 mb-8 text-center max-w-md">
          ¡Descubre nuestra colección de moda tradicional mexicana y llena tu carrito con piezas únicas!
        </p>
        <a routerLink="/tienda"
           class="px-8 py-4 bg-[#D11C5E] text-white font-bold text-sm uppercase tracking-wide rounded-lg hover:bg-[#b91750] transition-all duration-300 hover:scale-105 shadow-lg">
          <i class="fa-solid fa-store mr-2"></i>
          Ir a la Tienda
        </a>
      </div>
    } @else {
      <!-- CARRITO CON PRODUCTOS -->
      <div class="grid lg:grid-cols-3 gap-8">

        <!-- COLUMNA IZQUIERDA - PRODUCTOS -->
        <div class="lg:col-span-2 space-y-4">

          <!-- Encabezado -->
          <div class="bg-white rounded-lg shadow-sm p-6 border-b-4 border-[#D11C5E]">
            <div class="flex items-center justify-between">
              <h2 class="text-2xl font-black text-[#D11C5E] uppercase">
                Productos ({{ itemCount }})
              </h2>
              <button (click)="clearCart()"
                      class="text-sm text-gray-500 hover:text-red-500 transition-colors font-medium">
                <i class="fa-solid fa-trash mr-1"></i>
                Vaciar carrito
              </button>
            </div>
          </div>

          <!-- Lista de productos -->
          @for (item of cartItems; track item.id) {
            <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden">
              <div class="flex flex-col md:flex-row gap-6 p-6">

                <!-- Imagen del producto -->
                <div class="w-full md:w-40 h-48 md:h-40 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 group">
                  <img [src]="item.image"
                       [alt]="item.name"
                       class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                </div>

                <!-- Información del producto -->
                <div class="flex-1 flex flex-col">
                  <div class="flex-1">
                    <h3 class="text-xl font-black text-[#D11C5E] mb-2">{{ item.name }}</h3>
                    <p class="text-sm text-gray-600 mb-3">{{ item.description }}</p>

                    <!-- Detalles adicionales -->
                    <div class="flex gap-4 text-xs text-gray-500 mb-4">
                      @if (item.size) {
                        <div class="flex items-center gap-1">
                          <i class="fa-solid fa-ruler"></i>
                          <span>Talla: <strong>{{ item.size }}</strong></span>
                        </div>
                      }
                      @if (item.color) {
                        <div class="flex items-center gap-1">
                          <i class="fa-solid fa-palette"></i>
                          <span>Color: <strong>{{ item.color }}</strong></span>
                        </div>
                      }
                    </div>
                  </div>

                  <!-- Controles de cantidad y precio -->
                  <div class="flex flex-wrap items-center justify-between gap-4 pt-4 border-t border-gray-100">

                    <!-- Cantidad -->
                    <div class="flex items-center gap-3">
                      <span class="text-xs font-medium text-gray-600 uppercase">Cantidad:</span>
                      <div class="flex items-center gap-2 bg-gray-100 rounded-lg px-2 py-1">
                        <button (click)="updateQuantity(item.id, item.quantity - 1)"
                                class="w-8 h-8 bg-white rounded-lg flex items-center justify-center hover:bg-[#D11C5E] hover:text-white transition-all shadow-sm">
                          <i class="fa-solid fa-minus text-xs"></i>
                        </button>
                        <span class="text-base font-black w-8 text-center text-[#D11C5E]">{{ item.quantity }}</span>
                        <button (click)="updateQuantity(item.id, item.quantity + 1)"
                                class="w-8 h-8 bg-white rounded-lg flex items-center justify-center hover:bg-[#D11C5E] hover:text-white transition-all shadow-sm">
                          <i class="fa-solid fa-plus text-xs"></i>
                        </button>
                      </div>
                    </div>

                    <!-- Precio y eliminar -->
                    <div class="flex items-center gap-6">
                      <div class="text-right">
                        <div class="text-xs text-gray-500 mb-1">Precio unitario: ${{ item.price }}</div>
                        <div class="text-2xl font-black text-[#D11C5E]">
                          ${{ item.price * item.quantity }}
                          <span class="text-xs font-normal text-gray-500">MXN</span>
                        </div>
                      </div>
                      <button (click)="removeItem(item.id)"
                              class="text-gray-400 hover:text-red-500 transition-colors p-2">
                        <i class="fa-solid fa-trash text-lg"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }

          <!-- Botón continuar comprando -->
          <div class="pt-4">
            <a routerLink="/tienda"
               class="inline-flex items-center gap-2 text-[#D11C5E] font-bold hover:text-[#b91750] transition-colors">
              <i class="fa-solid fa-arrow-left"></i>
              <span class="uppercase text-sm tracking-wide">Continuar Comprando</span>
            </a>
          </div>
        </div>

        <!-- COLUMNA DERECHA - RESUMEN -->
        <div class="lg:col-span-1">
          <div class="sticky top-20">

            <!-- Resumen del pedido -->
            <div class="bg-white rounded-lg shadow-lg p-6 border-t-4 border-[#D11C5E]">
              <h3 class="text-2xl font-black text-black uppercase mb-6">Resumen</h3>

              <!-- Código de descuento -->
              <div class="mb-6 pb-6 border-b border-gray-200">
                <label class="block text-xs font-bold text-gray-700 uppercase mb-2">
                  <i class="fa-solid fa-tag mr-1"></i>
                  Código de Descuento
                </label>
                @if (!discountApplied) {
                  <div class="flex gap-2">
                    <input type="text"
                           [(ngModel)]="discountCode"
                           placeholder="Ingresa tu código"
                           class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[#D11C5E] focus:border-transparent">
                    <button (click)="applyDiscount()"
                            class="px-4 py-2 bg-gray-800 text-white text-sm font-bold rounded-lg hover:bg-black transition-colors uppercase">
                      Aplicar
                    </button>
                  </div>
                } @else {
                  <div class="bg-green-50 border-2 border-green-500 rounded-lg p-3 flex items-center justify-between">
                    <div class="flex items-center gap-2">
                      <i class="fa-solid fa-check-circle text-green-500"></i>
                      <span class="text-sm font-bold text-green-700">{{ discountCode }}</span>
                    </div>
                    <button (click)="removeDiscount()"
                            class="text-red-500 hover:text-red-700 transition-colors">
                      <i class="fa-solid fa-times"></i>
                    </button>
                  </div>
                }
                <p class="text-xs text-gray-500 mt-2">
                  <i class="fa-solid fa-info-circle"></i>
                  Prueba: <strong>YOLIK2026</strong> para 10% descuento
                </p>
              </div>

              <!-- Desglose de precios -->
              <div class="space-y-3 mb-6">
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Subtotal ({{ itemCount }} productos)</span>
                  <span class="font-bold text-black">${{ subtotal }}</span>
                </div>

                @if (discountAmount > 0) {
                  <div class="flex justify-between text-sm text-green-600">
                    <span class="flex items-center gap-1">
                      <i class="fa-solid fa-tag"></i>
                      Descuento
                    </span>
                    <span class="font-bold">-${{ discountAmount }}</span>
                  </div>
                }

                <div class="flex justify-between text-sm">
                  <span class="text-gray-600 flex items-center gap-1">
                    <i class="fa-solid fa-truck"></i>
                    Envío
                  </span>
                  @if (shipping === 0) {
                    <span class="font-bold text-green-600">GRATIS</span>
                  } @else {
                    <span class="font-bold text-black">${{ shipping }}</span>
                  }
                </div>

                @if (subtotal < freeShippingThreshold && subtotal > 0) {
                  <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-xs text-yellow-800">
                    <i class="fa-solid fa-info-circle mr-1"></i>
                    Agrega <strong>${{ freeShippingThreshold - subtotal }}</strong> más para envío gratis
                  </div>
                }
              </div>

              <!-- Total -->
              <div class="pt-4 border-t-2 border-gray-200 mb-6">
                <div class="flex justify-between items-center">
                  <span class="text-lg font-bold text-gray-700 uppercase">Total</span>
                  <div class="text-right">
                    <div class="text-3xl font-black text-[#D11C5E]">${{ total }}</div>
                    <div class="text-xs text-gray-500">MXN (IVA incluido)</div>
                  </div>
                </div>
              </div>

              <!-- Botones de acción -->
              <div class="space-y-3">
                <button (click)="proceedToCheckout()"
                        class="w-full py-4 bg-[#D11C5E] text-white font-black text-sm uppercase tracking-wide rounded-lg hover:bg-[#b91750] transition-all duration-300 hover:scale-105 shadow-lg hover:shadow-xl">
                  <i class="fa-solid fa-lock mr-2"></i>
                  Proceder al Pago
                </button>

                <a routerLink="/tienda"
                   class="block w-full py-4 bg-gray-200 text-gray-700 font-bold text-sm uppercase tracking-wide rounded-lg hover:bg-gray-300 transition-colors text-center">
                  <i class="fa-solid fa-store mr-2"></i>
                  Seguir Comprando
                </a>
              </div>

              <!-- Métodos de pago -->
              <div class="mt-6 pt-6 border-t border-gray-200">
                <p class="text-xs text-gray-500 text-center mb-3 uppercase font-medium">Métodos de Pago Aceptados</p>
                <div class="flex items-center justify-center gap-3 opacity-60">
                  <i class="fa-brands fa-cc-visa text-3xl"></i>
                  <i class="fa-brands fa-cc-mastercard text-3xl"></i>
                  <i class="fa-brands fa-cc-paypal text-3xl"></i>
                  <i class="fa-solid fa-credit-card text-2xl"></i>
                </div>
              </div>

              <!-- Garantía -->
              <div class="mt-6 bg-green-50 rounded-lg p-4">
                <div class="flex items-start gap-3">
                  <i class="fa-solid fa-shield-check text-2xl text-green-600"></i>
                  <div>
                    <h4 class="font-bold text-sm text-green-800 mb-1">Compra Segura</h4>
                    <p class="text-xs text-green-700">
                      Tus datos están protegidos. Envío asegurado y garantía de calidad.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Beneficios -->
            <div class="mt-6 bg-white rounded-lg shadow-sm p-6">
              <h4 class="font-black text-sm uppercase mb-4 text-gray-700">
                <i class="fa-solid fa-gift text-[#D11C5E] mr-2"></i>
                Beneficios YOLIK
              </h4>
              <ul class="space-y-3 text-xs text-gray-600">
                <li class="flex items-start gap-2">
                  <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                  <span>Envío gratis en compras mayores a $1,500</span>
                </li>
                <li class="flex items-start gap-2">
                  <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                  <span>Cambios y devoluciones gratis en 30 días</span>
                </li>
                <li class="flex items-start gap-2">
                  <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                  <span>Garantía de calidad artesanal</span>
                </li>
                <li class="flex items-start gap-2">
                  <i class="fa-solid fa-check text-green-500 mt-0.5"></i>
                  <span>Apoyas directamente a artesanas mexicanas</span>
                </li>
              </ul>
            </div>
          </div>
        </div>

      </div>
    }

  </div>
</section>

<!-- PRODUCTOS RELACIONADOS (OPCIONAL - PARA FUTURO) -->
@if (cartItems.length > 0) {
  <section class="w-full bg-white py-12 border-t border-gray-200">
    <div class="px-6 md:px-12 max-w-7xl mx-auto">
      <h2 class="text-3xl font-black text-center mb-8 uppercase text-[#D11C5E]">
        También te puede interesar
      </h2>
      <p class="text-center text-gray-500 text-sm mb-8">
        Completa tu look con estas piezas de nuestra colección
      </p>
      <!-- Aquí irían productos relacionados del backend -->
      <div class="text-center">
        <a routerLink="/tienda"
           class="inline-block px-8 py-3 bg-gray-100 text-gray-700 font-bold text-sm uppercase tracking-wide rounded-lg hover:bg-gray-200 transition-colors">
          Ver más productos
        </a>
      </div>
    </div>
  </section>
}

<!-- FOOTER -->
<footer class="w-full py-8 bg-white border-t border-gray-200">
  <div class="px-6 text-center">
    <p class="text-gray-600 text-sm">
      © 2026 YOLIK · Moda Tradicional de Tehuacán, Puebla
    </p>
  </div>
</footer>
